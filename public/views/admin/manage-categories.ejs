<% title = "Manage Categories and Subcategories" %>
<%- include('../partials/header'); %>

<div class="flex flex-row w-1/2">
    <%- include('../partials/sidebar'); %>
    <div class="px-4 py-5">
        <div class="py-2 inline-block min-w-full">
            <div class="shadow overflow-hidden border-b border-gray-200 sm:rounded-lg">
                <% if (flash.error) { %>
                    <div class="bg-red-500 p-4 mb-4">
                        <% flash.error.forEach((msg) => { %>
                            <p><%= msg %></p>
                        <% }); %>
                    </div>
                <% } %>
                <% if (flash.success) { %>
                    <p class="text-center font-semibold text-green-500 rounded-md bg-green-100 p-4">
                        <%= flash.success %>
                    </p>
                <% } %>

                <div class="mb-4">
                    <a href="/admin/dashboard/categories/create" class="px-4 py-2 bg-indigo-500 text-white rounded hover:bg-indigo-700">Create Category</a>
                    <a href="/admin/dashboard/subcategories/create" class="px-4 py-2 bg-indigo-500 text-white rounded hover:bg-indigo-700">Create Subcategory</a>
                </div>

                <table class="min-w-full">
                    <thead>
                        <tr>
                            <th class="px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider">
                                Category/Subcategory Name
                            </th>
                            <th class="px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider">
                                Actions
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <% categories.forEach((category) => { %>
                            <tr>
                                <td class="px-6 py-4 whitespace-no-wrap text-sm leading-5 font-medium text-gray-900">
                                    <%= category.name %> 
                                </td>
                                <td class="px-6 py-4 whitespace-no-wrap text-sm leading-5">
                                    <a href="/admin/dashboard/categories/edit/<%= category.id %>" class="text-indigo-600 hover:text-indigo-900">Rename</a>
                                    <a href="/admin/dashboard/categories/delete/<%= category.id %>" class="text-red-600 hover:text-red-900 ml-4">Delete</a>
                                </td>
                            </tr>

                            <% subcategories.filter((subcategory) => subcategory.category_id === category.id).forEach((subcategory) => { %>
                                <tr>
                                    <td class="px-6 py-4 whitespace-no-wrap text-sm leading-5 font-medium text-gray-900">
                                         ----- <%= subcategory.name %> 
                                    </td>
                                    <td class="px-6 py-4 whitespace-no-wrap text-sm leading-5">
                                        <a href="/admin/dashboard/subcategories/edit/<%= subcategory.id %>" class="text-indigo-600 hover:text-indigo-900">Rename</a>
                                        <a href="/admin/dashboard/subcategories/delete/<%= subcategory.id %>" class="text-red-600 hover:text-red-900 ml-4">Delete</a>
                                    </td>
                                </tr>
                            <% }); %>
                        <% }); %>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
</body>
</html>
